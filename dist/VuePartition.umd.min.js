(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["VuePartition"]=e():t["VuePartition"]=e()})("undefined"!==typeof self?self:this,(function(){return(()=>{var t={679:function(t,e){var i,r,s;(function(a,n){r=[],i=n,s="function"===typeof i?i.apply(e,r):i,void 0===s||(t.exports=s)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(f){var i,r,s,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,n=/@([^@]*):(\d+):(\d+)\s*$/gi,o=a.exec(f.stack)||n.exec(f.stack),l=o&&o[1]||!1,u=o&&o[2]||!1,d=document.location.href.replace(document.location.hash,""),c=document.getElementsByTagName("script");l===d&&(i=document.documentElement.outerHTML,r=new RegExp("(?:[^\\n]+?\\n){0,"+(u-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),s=i.replace(r,"$1").trim());for(var h=0;h<c.length;h++){if("interactive"===c[h].readyState)return c[h];if(c[h].src===l)return c[h];if(l===d&&c[h].innerHTML&&c[h].innerHTML.trim()===s)return c[h]}return null}}return t}))}},e={};function i(r){var s=e[r];if(void 0!==s)return s.exports;var a=e[r]={exports:{}};return t[r].call(a.exports,a,a.exports,i),a.exports}(()=>{i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}})(),(()=>{i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{i.p=""})();var r={};return(()=>{"use strict";if(i.r(r),i.d(r,{default:()=>p}),"undefined"!==typeof window){var t=window.document.currentScript,e=i(679);t=e(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:e});var s=t&&t.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);s&&(i.p=s[1])}var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ui-partition"},[i("div",{ref:"ui-field",staticClass:"ui-partition__field"},[i("div",{staticClass:"ui-partition__items"},t._l(t.options,(function(e,r){return i("div",{key:r,ref:"ui-item-"+r,refInFor:!0,staticClass:"ui-partition__item",style:{"--item-background":t.currentStyles(e).background,width:t.parseValueToWidth(e.value)+"px"}},[e.editable?i("div",{ref:"ui-control-"+r,refInFor:!0,staticClass:"ui-partition__control",style:{"--control-background":t.currentStyles(e).control.background,"--control-border":t.currentStyles(e).control.border,"--arrow-size":t.currentStyles(e).arrows.size,"z-index":t.lastControlIndex===r?2:1}},[i("div",{staticClass:"ui-partition__arrow ui-partition__arrow--left",style:{"--arrow-background":t.currentStyles(e,r).arrows.prev.background,"--arrow-border":t.currentStyles(e).arrows.prev.border}}),i("div",{staticClass:"ui-partition__arrow ui-partition__arrow--right",style:{"--arrow-background":t.currentStyles(e,r).arrows.next.background,"--arrow-border":t.currentStyles(e).arrows.next.border}})]):t._e()])})),0)])])},n=[];const o={model:{prop:"options",event:"input"},props:{options:{type:Array,required:!0},total:{type:Number,default:null},step:{type:Number,default:1,validator(t){return t%1===0&&t>=1}},disabled:{type:Boolean,default:!1},minValue:{type:Number,default:0,validator(t){return t>=0}},maxValue:{type:Number,default:null}},data(){return{fieldWidth:null,isTracking:!1,lastControlIndex:null,control:{index:null,el:null,rect:{},data:{}},shiftState:{width:null,value:null,movementSide:""},sourceTotal:null}},created(){this.sourceOptions=this.options,this.sourceTotal=this.total||this.options.reduce(((t,e)=>(t+=e.value||0,t)),0)},mounted(){this.fieldWidth=this.$refs["ui-field"].getBoundingClientRect().width,this.sourceOptions.forEach(((t,e)=>{if(t.editable){const t=this.getRefDetail(`ui-control-${e}`);t.el.addEventListener("pointerdown",(t=>{this.handleClick(t,e)}))}}))},beforeDestroy(){this.closeTracking()},computed:{sourceOptions:{get(){return this.options},set(t){this.$emit("input",t)}},availableStep(){return this.fieldWidth/this.sourceTotal*this.step}},methods:{handleClick(t,e){if(this.disabled||this.isTracking)return!1;this.isTracking=!0,this.lastControlIndex=e,this.control=this.getRefDetail(`ui-item-${e}`);const i=this.$refs["ui-field"];i.addEventListener("pointermove",this.handleMovement),i.addEventListener("pointerup",this.closeTracking),i.addEventListener("pointerleave",this.closeTracking)},handleMovement({pageX:t}){const e=this.getRefDetail(`ui-item-${this.control.index}`);if(e.data.disabled)return!1;const i=t-(e.rect.left+e.rect.width),r=this.parseWidthToValue(this.getWidthByAvailableStep(Math.abs(i)));this.shiftState={width:i,value:r,movementSide:i>0?"right":"left"};const s=this.isAccessedMovement(this.getWidthByAvailableStep(e.rect.width,this.shiftState.width));s&&this.updateRefs()},updateRefs(t=!1){if(0===Math.abs(this.shiftState.width))return!1;for(let e=this.control.index+1;e<this.sourceOptions.length;e++){const t=this.getRefDetail(`ui-item-${e}`);if(t.isValid){if("right"===this.shiftState?.movementSide){if(this.sourceOptions[this.control.index].value+=this.shiftState.value,t.data.value-this.shiftState.value<=0){const i=this.shiftState.value-t.data.value;return this.sourceOptions[this.control.index].value-=i,this.shiftState={...this.shiftState,width:this.parseValueToWidth(i),value:i},this.sourceOptions[e].value=0,!1}this.sourceOptions[e].value-=this.shiftState.value}if("left"===this.shiftState?.movementSide){const t=this.getAvailableNextRef("left"),{minValue:i=this.minValue||0,maxValue:r=this.maxValue||0,value:s}=this.control.data;if(!t&&s<=i)return!1;const{minValue:a=this.minValue||0,maxValue:n=this.maxValue||null,value:o}=t.data||{};switch(!0){case t&&0===t.index&&o-this.shiftState.value<=0&&s<=i:this.sourceOptions[t.index].value=a;break;case t&&t.data.value-this.shiftState.value<=a&&s<=i:{const i=o-a,r=this.shiftState.value-i;if(0===t.index){this.sourceOptions[t.index].value=a,this.sourceOptions[e].value+=i;break}this.sourceOptions[t.index-1].value-=r,this.sourceOptions[e].value+=r+i,this.sourceOptions[t.index].value=a;break}case t&&s-this.shiftState.value<=i:{const r=s-i,a=this.shiftState.value-r;if("local"===this.control.data.editType){this.sourceOptions[e].value+=r,this.sourceOptions[this.control.index].value=i;break}this.sourceOptions[t.index].value-=a,this.sourceOptions[e].value+=a+r,this.sourceOptions[this.control.index].value=i;break}default:if(!t&&this.control.data.value-this.shiftState.value<=i){this.shiftState.value,this.control.data.value;this.sourceOptions[this.control.index].value=i,this.sourceOptions[e].value+=s-i;break}this.sourceOptions[this.control.index].value-=this.shiftState.value,this.sourceOptions[e].value+=this.shiftState.value;break}}this.shiftState={width:null,value:null,movementSide:""}}}},isAccessedMovement(t){if(0===this.shiftState.value||!this.isTracking)return!1;const{maxValue:e=this.maxValue||null,minValue:i=this.minValue||0,value:r}=this.control.data,s=this.control.data.value>i;switch(!0){case"left"===this.shiftState.movementSide&&!s:{if("local"===this.control.data.editType)return!1;const t=this.getAvailableNextRef("left"),e=this.sourceOptions.slice(0,this.control.index);switch(!0){case this.control.data.value<=0&&!t:return!1;default:return this.control.data.value>0||e.some((t=>t.value>0))}}case"right"===this.shiftState.movementSide:{const t=this.getAvailableNextRef(),{value:s,minValue:a=this.minValue||0}=t.data;if("local"===this.control.data.editType&&t.index!==this.control.index+1)return!1;const n=i<=this.control.data.value,o=!!t&&t.data.value>t.data.minValue||n;return e?r<e&&o:o}default:{const t=this.getAvailableNextRef("right");return!!t&&(!t.disabled&&t.isValid)}}return!1},getRefDetail(t){const e=this.$refs[t][0]||this.$refs[t],i=Number.parseInt(t.split("-")[2],10);let r={index:i,el:e,rect:{width:e.getBoundingClientRect().width,left:e.getBoundingClientRect().left},data:this.sourceOptions[i]};return r.isValid=this.isValidRef(r),r},getAvailableNextRef(t=""){const e=this.sourceOptions.findIndex((t=>!!t?.focused)),{minValue:i=this.minValue||0}=this.control.data;if(e>=0){const t=this.getRefDetail(`ui-item-${e}`);if(t.isValid)return t}switch(!0){case"right"===t:case"right"===this.shiftState.movementSide:for(let t=this.control.index+1;t<this.sourceOptions.length-1;t++){const e=this.getRefDetail(`ui-item-${t}`);if(e.isValid)return e}break;case"left"===t:case"left"===this.shiftState.movementSide&&this.control.data.value<=i:for(let t=this.control.index-1;t>=0;t--){const e=this.getRefDetail(`ui-item-${t}`),i=e.data.minValue||this.minValue||0;if(e.isValid&&e.data.value>i)return e}break;case"left"===this.shiftState.movementSide:for(let t=this.control.index+1;t<=this.sourceOptions.length-1;t++){const e=this.getRefDetail(`ui-item-${t}`),i=e.data.minValue||this.minValue||0;if(e.isValid&&e.data.value>i)return e}break;default:break}return!1},isValidRef(t){const{disabled:e=!1,value:i,minValue:r=this.minValue||0,maxValue:s=this.maxValue||this.sourceTotal}=t.data;switch(!0){case e:return!1;case"right"===this.shiftState.movementSide:return r<i;case"left"===this.shiftState.movementSide:return r<=i&&i<s;default:return!1}},fieldState(){let t=0,e=0;for(let i=0;i<this.sourceOptions.length;i++){const r=this.getRefDetail(`ui-item-${i}`);t+=parseInt(r.el.style.width),e+=r.data.value}return{total:t,untracked:this.getWidthByAvailableStep(this.fieldWidth-t),totalValue:this.parseWidthToValue(t)}},closeTracking(){if(!this.isTracking)return!1;const t=this.$refs["ui-field"];t.removeEventListener("pointermove",this.handleMovement),this.sourceOptions=this.sourceOptions.map((t=>{const e=t.minValue||this.minValue||0,i=t.maxValue||this.maxValue||null;switch(!0){case t.value<e:return t.value=e,t;case i&&t.value>i:return t.value=i,t;default:return t}})),this.control={},this.shiftState={},this.isTracking=!1},currentStyles(t,e=null){const i=t.settings,{control:r={},arrows:s={}}=t.settings,a={background:i.background||"transparent",control:{background:r?.background||"#FFFFFF",border:[`${r?.borderWidth||1}px`,r?.borderStyle||"solid",r?.borderColor||"transparent"].join(" ")},arrows:{size:`${s?.size||10}px`,prev:{background:s?.prev?.background||s?.background||"#FFF",border:[`${s?.prev?.borderWidth||s?.borderWidth||1}px`,s?.prev?.borderStyle||s?.borderStyle||"solid",s?.prev?.borderColor||s?.borderColor||"transparent"].join(" ")},next:{background:s?.next?.background||s?.background||"#FFF",border:[`${s?.next?.borderWidth||s?.borderWidth||1}px`,s?.next?.borderStyle||s?.borderStyle||"solid",s?.next?.borderColor||s?.borderColor||"transparent"].join(" ")}}};return a},getWidthByAvailableStep(t,e=0){const i=t-t%this.availableStep,r=Math.abs(e)-Math.abs(e)%this.availableStep;switch(!0){case 0===e:return i;case"right"===this.shiftState.movementSide:return i+r;case"left"===this.shiftState.movementSide:return i-r;default:return i}},parseValueToWidth(t){return t*(this.fieldWidth/this.sourceTotal)},parseWidthToValue(t){return t/this.availableStep}}},l=o;function u(t,e,i,r,s,a,n,o){var l,u="function"===typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=i,u._compiled=!0),r&&(u.functional=!0),a&&(u._scopeId="data-v-"+a),n?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},u._ssrRegister=l):s&&(l=o?function(){s.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(u.functional){u._injectStyles=l;var d=u.render;u.render=function(t,e){return l.call(e),d(t,e)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:t,options:u}}var d=u(l,a,n,!1,null,null,null);const c=d.exports,h=t=>{t.component("VuePartition",c)},f=h,p=f})(),r})()}));
//# sourceMappingURL=VuePartition.umd.min.js.map